server {
    listen 80 default_server;
    listen [::]:80 default_server;

    # Web Root
    root /var/www/html;
    index index.html;

    server_name _;

    # --- CAPTIVE PORTAL TRIGGERS ---
    
    # iOS/macOS Captive Network Assistant check
    location /hotspot-detect.html {
        return 302 http://192.168.4.1/index.html;
    }

    # Android Gen 204 Check
    location /generate_204 {
        return 302 http://192.168.4.1/index.html;
    }

    # Catch-all redirect
    # If they try to go to google.com, redirect to our landing page
    location / {
        try_files $uri $uri/ /index.html;
    }

    # Video Optimization
    location /video/ {
        mp4;
        mp4_buffer_size 1m;
        mp4_max_buffer_size 5m;
    }
}
